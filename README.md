# A Fast Ecological Inference Algorithm for the RxC Case

This repository contains all of the code and data used to generate the figures and tables for the corresponding paper.

Part of the repository uses the corresponding R library.

> **Note:** All commands should be run from the root of this repository.

---

## Folder Structure

### Data

```
├── data
│   └── 2021_11_Presidencial.xlsx
```

The raw data, obtained from verified sources. 

### Figures 

```
├── figures
│   ├── fig1-em-time.pdf
│   ├── fig3-line.pdf
│   ├── fig4-scatter.pdf
│   ├── fig5-cascade.pdf
│   ├── fig8-map.pdf
│   ├── fig9-heatmap.pdf
│   ├── figO-histogram.pdf
│   ├── figP-boxplot.pdf
│   └── figQ-line.pdf

```

The generated figures, exported in PDF format. All figures are produced by the scripts in the `src/` folder or the R library.

### Output 

```
├── output
│   ├── figure3
│   ├── figure4
│   ├── figureH
│   ├── results_districts
│   ├── results_districts_age40
│   ├── results_districts_sex
│   └── simulated_instances
```

The generated data—either processed from the raw files in the `data/` folder or produced as simulated instances. Also, stores the results of certain instances ran in `src/`. 

### Src

```
├── src
│   ├── R_functions.R
│   ├── aux_functions.py
│   ├── fig1_2_data.R
│   ├── fig1_em_time.py
│   ├── fig2_em_error.py
│   ├── fig3_data.R
│   ├── fig3_line.py
│   ├── fig4_data.R
│   ├── fig4_scatter.py
│   ├── fig5_data.R
│   ├── fig5_data.sh
│   ├── fig5_triple.py
│   ├── fig6_7_data.py
│   ├── fig6_avg_age_scatter.py
│   ├── fig7_age_corr.py
│   ├── fig8_map.R
│   ├── fig9_heatmap.py
│   ├── fig9_table2_data.py
│   ├── figN_data.R
│   ├── figO_histogram.py
│   ├── figP_box.py
│   ├── figP_data.R
│   ├── figQ_line.py
│   ├── mcmc_simulations
│   ├── p_val_mult.py
│   ├── tabe1_convergence.py
│   ├── table2_pvalues.py
│   └── tableE_data.R
```

Directory containing all scripts for generating data, figures, and tables.

### Tables 

```
└── tables
    └── table2.txt
```
The tables used in the paper, formatted for LaTeX and saved as `.txt`.

--- 

## Usage

### Example: Average Run Time

![Average run time](figures/fig1-em-time.pdf)

 First, generate the data by running:

```bash
Rscript src/fig1_2_data.R
```

This will create the data files in the `output/` directory. 

Next, generate the plot by running:

```bash
python3 src/fig1_em_error.py
```

The resulting figure will be saved in the `figures/` directory under its corresponding filename. You can adjust the output path by modifying the global variable in `src/fig1_em_error.py`.

> Note:  All of the figures may be generated by this same methology with its corresponding files.
